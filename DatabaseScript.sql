IF OBJECT_ID('dbo.COURSE', 'U') IS NOT NULL 
	DROP TABLE dbo.COURSE
IF OBJECT_ID('dbo.USERS', 'U') IS NOT NULL 
	DROP TABLE dbo.USERS
IF OBJECT_ID('dbo.SECTION', 'U') IS NOT NULL 
	DROP TABLE dbo.SECTION
IF OBJECT_ID('dbo.ROOM', 'U') IS NOT NULL 
	DROP TABLE dbo.ROOM
IF OBJECT_ID('dbo.LIBRARY', 'U') IS NOT NULL 
	DROP TABLE dbo.LIBRARY
IF OBJECT_ID('dbo.USER_COURSE', 'U') IS NOT NULL 
	DROP TABLE dbo.USER_COURSE
IF OBJECT_ID('dbo.FRIENDSHIP', 'U') IS NOT NULL 
	DROP TABLE dbo.FRIENDSHIP

CREATE TABLE USERS
(
	UFID INT NOT NULL,
	USERS_NAME VARCHAR(100) NOT NULL ,
	USERS_MAJOR VARCHAR(100) NOT NULL ,
	USERS_ACTIVE BIT NOT NULL,
	PRIMARY KEY ( UFID )
);

CREATE TABLE COURSE
(
	COURSE_ID INT NOT NULL IDENTITY(1,1),
	COURSE_NAME VARCHAR(100) NOT NULL ,
	PRIMARY KEY ( COURSE_ID )
);

CREATE TABLE LIBRARY
(
	LIBRARY_ID INT NOT NULL IDENTITY(1,1),
	LIBRARY_NAME VARCHAR(100) NOT NULL ,
	PRIMARY KEY ( LIBRARY_ID )
);

CREATE TABLE ROOM
(
	ROOM_ID INT NOT NULL IDENTITY(1,1),
	ROOM_NAME VARCHAR(100) NOT NULL ,
	LIBRARY_ID INT NOT NULL, 
	PRIMARY KEY ( ROOM_ID ),
	CONSTRAINT fk_LibRoom FOREIGN KEY ( LIBRARY_ID ) 
	REFERENCES LIBRARY( LIBRARY_ID )
);

CREATE TABLE SECTION
(
	SECTION_ID INT NOT NULL IDENTITY(1,1),
	CAPACITY INT NOT NULL,
	COUNT INT NOT NULL,
	NAME VARCHAR(100) NOT NULL,
	LIBRARY_ID INT NOT NULL,
	PRIMARY KEY ( SECTION_ID ),
	CONSTRAINT fk_LibSection FOREIGN KEY ( LIBRARY_ID ) 
	REFERENCES LIBRARY( LIBRARY_ID )	
);

CREATE TABLE USERS_COURSE
(
	UFID INT,
	COURSE_ID INT,
	PRIMARY KEY ( UFID, COURSE_ID ),
	CONSTRAINT fk_User FOREIGN KEY ( UFID ) REFERENCES USERS( UFID ),
	CONSTRAINT fk_Course FOREIGN KEY ( COURSE_ID ) REFERENCES COURSE(COURSE_ID)
);

CREATE TABLE FRIENDSHIP
(
	USERS_1 INT ,
	USERS_2 INT ,
	PRIMARY KEY ( USERS_1, USERS_2 ),
	CONSTRAINT fk_User1 FOREIGN KEY (USERS_1) REFERENCES USERS(UFID),
	CONSTRAINT fk_User2 FOREIGN KEY (USERS_2) REFERENCES USERS(UFID)
);